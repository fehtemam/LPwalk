ylimt2 <- list(ylimt[[1]][1],ylimt[[2]][1],ylimt[[3]][1],ylimt[[4]][1],ylimt[[5]][1])
ylimt3 <- list(abs(ylimt[[1]][2]-ylimt[[1]][1])*0.05,abs(ylimt[[2]][2]-ylimt[[2]][1])*0.05,abs(ylimt[[3]][2]-ylimt[[3]][1])*0.05,abs(ylimt[[4]][2]-ylimt[[4]][1])*0.05,abs(ylimt[[5]][2]-ylimt[[5]][1])*0.05)
pl_tKl <- vector("list", 5)
pl_tKl <- mapply(function(v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13) {
ggplot(data = v1, aes(x2, v2)) +
geom_line(aes(x2, v2), linetype = 1, lwd =1.0, color="red4") +
geom_ribbon(aes(ymin = v3, ymax = v4), alpha = .3, fill="red2", color="red2") +
geom_line(aes(x2, v5), linetype = 1, lwd =1.0, color="blue4") +
geom_ribbon(aes(ymin = v6, ymax = v7), alpha = .3, fill="blue2", color="blue2") +
geom_rect(aes(xmin = 0, xmax = 64, ymin = v10, ymax = v10+v11), alpha = 0.8, fill = 'green4', inherit.aes = FALSE) +
# geom_vline(aes(xintercept = 0.63*length(x1)), colour="black", linetype="dashed",   lwd =1.0) +
# geom_vline(aes(xintercept = mids*length(x2)), colour="magenta", linetype="dashed", lwd =1.0) +
scale_y_continuous(limits=v9, expand = c(0, 0)) +
scale_x_continuous(limits=c(0, 100), expand = c(0, 0), breaks=seq(20,80,20),
labels = c("20%", "40%", "60%", "80%")) +
xlab("") +
ylab(v13) +
ggtitle("") +
theme(plot.title = element_text(lineheight=.8, face="bold", size = 25),
# axis.text.y = eval(parse(text=v6)),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
axis.title.x = element_text(size=20,face="bold", color = "dimgray"),
axis.title.y = element_text(size=20,face="bold", color = "dimgray"),
axis.line = element_line(colour = "black"),
axis.line.x = element_line(size = 2),
plot.margin=unit(v12, "cm"),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank(),
legend.position = v8) +
geom_hline(aes(yintercept=0), colour="black", linetype="dotted", lwd =1.0)
}, sig1, KIN_tHa2, low1, up1, KIN_tLa2, low2, up2, lgp, ylimt, ylimt2, ylimt3, ymarg, ylabs1, SIMPLIFY = F)
pl_tKl[[3]]
trp_Kl <- do.call("grid.arrange", c(pl_tKl[2:5], ncol = 4))
ggsave(filename = "trp_Kl.png", plot(trp_Kl) ,width = 16, height = 3, units = "in", dpi = 600)
pl_tKl <- mapply(function(v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13) {
ggplot(data = v1, aes(x2, v2)) +
geom_line(aes(x2, v2), linetype = 1, lwd =1.0, color="red4") +
geom_ribbon(aes(ymin = v3, ymax = v4), alpha = .3, fill="red2", color="red2") +
geom_line(aes(x2, v5), linetype = 1, lwd =1.0, color="blue4") +
geom_ribbon(aes(ymin = v6, ymax = v7), alpha = .3, fill="blue2", color="blue2") +
geom_rect(aes(xmin = 0, xmax = 14, ymin = v10, ymax = v10+v11), alpha = 0.8, fill = 'green4', inherit.aes = FALSE) +
geom_rect(aes(xmin = 64, xmax = 100, ymin = v10, ymax = v10+v11), alpha = 0.8, fill = 'green4', inherit.aes = FALSE) +
# geom_vline(aes(xintercept = 0.63*length(x1)), colour="black", linetype="dashed",   lwd =1.0) +
# geom_vline(aes(xintercept = mids*length(x2)), colour="magenta", linetype="dashed", lwd =1.0) +
scale_y_continuous(limits=v9, expand = c(0, 0)) +
scale_x_continuous(limits=c(0, 100), expand = c(0, 0), breaks=seq(20,80,20),
labels = c("20%", "40%", "60%", "80%")) +
xlab("") +
ylab(v13) +
ggtitle("") +
theme(plot.title = element_text(lineheight=.8, face="bold", size = 25),
# axis.text.y = eval(parse(text=v6)),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
axis.title.x = element_text(size=20,face="bold", color = "dimgray"),
axis.title.y = element_text(size=20,face="bold", color = "dimgray"),
axis.line = element_line(colour = "black"),
axis.line.x = element_line(size = 2),
plot.margin=unit(v12, "cm"),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank(),
legend.position = v8) +
geom_hline(aes(yintercept=0), colour="black", linetype="dotted", lwd =1.0)
}, sig1, KIN_tHa2, low1, up1, KIN_tLa2, low2, up2, lgp, ylimt, ylimt2, ylimt3, ymarg, ylabs1, SIMPLIFY = F)
pl_tKl[[2]]
pl_tKl[[3]]
pl_tKl[[4]]
pl_tKl[[5]]
trp_Kl <- do.call("grid.arrange", c(pl_tKl[2:5], ncol = 4))
ggsave(filename = "trp_Kl.png", plot(trp_Kl) ,width = 16, height = 3, units = "in", dpi = 600)
jet.colors <- colorRampPalette(c("#00007F", "blue", "#007FFF", "cyan", "#7FFF7F", "yellow", "#FF7F00", "red", "#7F0000"))
lgp <- as.list(c("none", "none","none","none","none"))  # legend position
ymarg <- list(c(0.2, 0.1, 0, 0), c(0.2, 0.1, 0, 0), c(0.2, 0.1, 0, 0), c(0.2, 0.1, 0, 0), c(0.2, 0.1, 0, 0))
# tty <- as.list(c("", "Leg angle", "Ankle angle", "Knee angle", "Hip angle"))
tty <- as.list(c("", "Heel AP", "Ankle AP", "Knee AP", "Hip AP"))
ylabs1 <- as.list(c("Ipsi. (deg/m)", "Ipsi. (deg/m)", "", "", ""))
ylabs2 <- as.list(c("Contra. (deg/m)", "Contra. (deg/m)", "", "", ""))
ylabs3 <- as.list(c("deg", "deg", "", "", ""))
files <- list.files(pattern = "sliceKAmh[1-5].csv")
KIN_mH <- lapply(files, read.csv, header = FALSE)
#
files <- list.files(pattern = "sliceKAml[1-5].csv")
KIN_mL <- lapply(files, read.csv, header = FALSE)
files <- list.files(pattern = "sliceKTmhR[1-5].csv")
KIN_tHr <- lapply(files, read.csv, header = FALSE)
#
files <- list.files(pattern = "sliceKTmhL[1-5].csv")
KIN_tHl <- lapply(files, read.csv, header = FALSE)
#
files <- list.files(pattern = "sliceKTmlR[1-5].csv")
KIN_tLr <- lapply(files, read.csv, header = FALSE)
#
files <- list.files(pattern = "sliceKTmlL[1-5].csv")
KIN_tLl <- lapply(files, read.csv, header = FALSE)
KIN_mHa <- lapply(KIN_mH, colMeans)
KIN_mLa <- lapply(KIN_mL, colMeans)
KIN_tHar <- lapply(KIN_tHr, colMeans)
KIN_tHal <- lapply(KIN_tHl, colMeans)
KIN_tLar <- lapply(KIN_tLr, colMeans)
KIN_tLal <- lapply(KIN_tLl, colMeans)
KIN_mHs <- lapply(KIN_mH, function(x) {apply(x, 2, sd)})
KIN_mLs <- lapply(KIN_mL, function(x) {apply(x, 2, sd)})
KIN_tHsr <- lapply(KIN_tHr, function(x) {apply(x, 2, sd)})
KIN_tHsl <- lapply(KIN_tHl, function(x) {apply(x, 2, sd)})
KIN_tLsr <- lapply(KIN_tLr, function(x) {apply(x, 2, sd)})
KIN_tLsl <- lapply(KIN_tLl, function(x) {apply(x, 2, sd)})
sig1 <- lapply(KIN_mHa, as.data.frame)
sig2 <- lapply(KIN_mLa, as.data.frame)
low1 =  mapply(function(x,y) {x+(-1*qt(0.975,df)*y/sqrt(ns))}, sig1, KIN_mHs)
up1 =  mapply(function(x,y) {x+(1*qt(0.975,df)*y/sqrt(ns))}, sig1, KIN_mHs)
low2 =  mapply(function(x,y) {x+(-1*qt(0.975,df)*y/sqrt(ns))}, sig2, KIN_mLs)
up2 =  mapply(function(x,y) {x+(1*qt(0.975,df)*y/sqrt(ns))}, sig2, KIN_mLs)
yliml <- c(-2,-20,-20,-20,-20)
ylimu <- c(3,30,30,30,30,30)
pl_mK <- vector("list", 5)
pl_mK <- mapply(function(v1,v2,v3,v4,v5,v6,v7,v8,v9,v10) {
ggplot(data = v1, aes(x2, v2)) +
geom_line(aes(x2, v2), linetype = 1, lwd =1.0, color="red4") +
geom_ribbon(aes(ymin = v3, ymax = v4), alpha = .3, fill="red2", color="red2") +
geom_line(aes(x2, v5), linetype = 1, lwd =1.0, color="blue4") +
geom_ribbon(aes(ymin = v6, ymax = v7), alpha = .3, fill="blue2", color="blue2") +
# geom_vline(aes(xintercept = 0.63*length(x1)), colour="black", linetype="dashed",   lwd =1.0) +
# geom_vline(aes(xintercept = mids*length(x2)), colour="magenta", linetype="dashed", lwd =1.0) +
scale_y_continuous(expand = c(0, 0)) +
scale_x_continuous(limits=c(0, 100), expand = c(0, 0), breaks=seq(20,80,20),
labels = c("20%", "40%", "60%", "80%")) +
xlab("") +
ylab(v10) +
ggtitle(v9) +
theme(plot.title = element_text(lineheight=.8, face="bold", size = 25),
# axis.text.y = eval(parse(text=v6)),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
axis.title.x = element_text(size=20,face="bold", color = "dimgray"),
axis.title.y = element_text(size=20,face="bold", color = "dimgray"),
axis.line = element_line(colour = "black"),
axis.line.x = element_line(size = 2),
# plot.margin=unit(v7, "cm"),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank(),
legend.position = v8) +
geom_hline(aes(yintercept=0), colour="black", linetype="dotted", lwd =1.0)
}, sig1, KIN_mHa, low1, up1, KIN_mLa, low2, up2, lgp, tty, ylabs3, SIMPLIFY = F)
pl_mK[[2]]
pl_mK[[3]]
pl_mK[[4]]
pl_mK[[5]]
mp_K <- do.call("grid.arrange", c(pl_mK[2:5], ncol = 4))
ggsave(filename = "mp_K2.png", plot(mp_K) ,width = 16, height = 3, units = "in", dpi = 600)
# KIN (transient) Right
KIN_tHa2 <- lapply(KIN_tHar, '[', 1:100)
KIN_tLa2 <- lapply(KIN_tLar, '[', 1:100)
KIN_tHs2 <- lapply(KIN_tHsr, '[', 1:100)
KIN_tLs2 <- lapply(KIN_tLsr, '[', 1:100)
sig1 <- lapply(KIN_tHa2, as.data.frame)
sig2 <- lapply(KIN_tLa2, as.data.frame)
low1 =  mapply(function(x,y) {x+(-1*qt(0.975,df)*y/sqrt(ns))}, sig1, KIN_tHs2)
up1 =  mapply(function(x,y) {x+(1*qt(0.975,df)*y/sqrt(ns))}, sig1, KIN_tHs2)
low2 =  mapply(function(x,y) {x+(-1*qt(0.975,df)*y/sqrt(ns))}, sig2, KIN_tLs2)
up2 =  mapply(function(x,y) {x+(1*qt(0.975,df)*y/sqrt(ns))}, sig2, KIN_tLs2)
ylimt <- list(c(-20,30),c(-150,100),c(-400,650),c(-300,300),c(-150,100))
ylimt2 <- list(ylimt[[1]][1],ylimt[[2]][1],ylimt[[3]][1],ylimt[[4]][1],ylimt[[5]][1])
ylimt3 <- list(abs(ylimt[[1]][2]-ylimt[[1]][1])*0.05,abs(ylimt[[2]][2]-ylimt[[2]][1])*0.05,abs(ylimt[[3]][2]-ylimt[[3]][1])*0.05,abs(ylimt[[4]][2]-ylimt[[4]][1])*0.05,abs(ylimt[[5]][2]-ylimt[[5]][1])*0.05)
pl_tKr <- vector("list", 5)
pl_tKr <- mapply(function(v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13) {
ggplot(data = v1, aes(x2, v2)) +
geom_line(aes(x2, v2), linetype = 1, lwd =1.0, color="red4") +
geom_ribbon(aes(ymin = v3, ymax = v4), alpha = .3, fill="red2", color="red2") +
geom_line(aes(x2, v5), linetype = 1, lwd =1.0, color="blue4") +
geom_ribbon(aes(ymin = v6, ymax = v7), alpha = .3, fill="blue2", color="blue2") +
geom_rect(aes(xmin = 0, xmax = 64, ymin = v10, ymax = v10+v11), alpha = 0.8, fill = 'green4', inherit.aes = FALSE) +
# geom_vline(aes(xintercept = 0.63*length(x1)), colour="black", linetype="dashed",   lwd =1.0) +
# geom_vline(aes(xintercept = mids*length(x2)), colour="magenta", linetype="dashed", lwd =1.0) +
scale_y_continuous(limits=v9, expand = c(0, 0)) +
scale_x_continuous(limits=c(0, 100), expand = c(0, 0), breaks=seq(20,80,20),
labels = c("20%", "40%", "60%", "80%")) +
xlab("") +
ylab(v13) +
ggtitle("") +
theme(plot.title = element_text(lineheight=.8, face="bold", size = 25),
# axis.text.y = eval(parse(text=v6)),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
axis.title.x = element_text(size=20,face="bold", color = "dimgray"),
axis.title.y = element_text(size=20,face="bold", color = "dimgray"),
axis.line = element_line(colour = "black"),
axis.line.x = element_line(size = 2),
plot.margin=unit(v12, "cm"),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank(),
legend.position = v8) +
geom_hline(aes(yintercept=0), colour="black", linetype="dotted", lwd =1.0)
}, sig1, KIN_tHa2, low1, up1, KIN_tLa2, low2, up2, lgp, ylimt, ylimt2, ylimt3, ymarg, ylabs1, SIMPLIFY = F)
pl_tKr[[2]]
ylimt <- list(c(-20,30),c(-5,5),c(-5,5),c(-5,5),c(-5,5))
ylimt2 <- list(ylimt[[1]][1],ylimt[[2]][1],ylimt[[3]][1],ylimt[[4]][1],ylimt[[5]][1])
ylimt3 <- list(abs(ylimt[[1]][2]-ylimt[[1]][1])*0.05,abs(ylimt[[2]][2]-ylimt[[2]][1])*0.05,abs(ylimt[[3]][2]-ylimt[[3]][1])*0.05,abs(ylimt[[4]][2]-ylimt[[4]][1])*0.05,abs(ylimt[[5]][2]-ylimt[[5]][1])*0.05)
pl_tKr <- vector("list", 5)
pl_tKr <- mapply(function(v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13) {
ggplot(data = v1, aes(x2, v2)) +
geom_line(aes(x2, v2), linetype = 1, lwd =1.0, color="red4") +
geom_ribbon(aes(ymin = v3, ymax = v4), alpha = .3, fill="red2", color="red2") +
geom_line(aes(x2, v5), linetype = 1, lwd =1.0, color="blue4") +
geom_ribbon(aes(ymin = v6, ymax = v7), alpha = .3, fill="blue2", color="blue2") +
geom_rect(aes(xmin = 0, xmax = 64, ymin = v10, ymax = v10+v11), alpha = 0.8, fill = 'green4', inherit.aes = FALSE) +
# geom_vline(aes(xintercept = 0.63*length(x1)), colour="black", linetype="dashed",   lwd =1.0) +
# geom_vline(aes(xintercept = mids*length(x2)), colour="magenta", linetype="dashed", lwd =1.0) +
scale_y_continuous(limits=v9, expand = c(0, 0)) +
scale_x_continuous(limits=c(0, 100), expand = c(0, 0), breaks=seq(20,80,20),
labels = c("20%", "40%", "60%", "80%")) +
xlab("") +
ylab(v13) +
ggtitle("") +
theme(plot.title = element_text(lineheight=.8, face="bold", size = 25),
# axis.text.y = eval(parse(text=v6)),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
axis.title.x = element_text(size=20,face="bold", color = "dimgray"),
axis.title.y = element_text(size=20,face="bold", color = "dimgray"),
axis.line = element_line(colour = "black"),
axis.line.x = element_line(size = 2),
plot.margin=unit(v12, "cm"),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank(),
legend.position = v8) +
geom_hline(aes(yintercept=0), colour="black", linetype="dotted", lwd =1.0)
}, sig1, KIN_tHa2, low1, up1, KIN_tLa2, low2, up2, lgp, ylimt, ylimt2, ylimt3, ymarg, ylabs1, SIMPLIFY = F)
pl_tKr[[2]]
pl_tKr[[3]]
pl_tKr[[4]]
pl_tKr[[5]]
ylimt <- list(c(-20,30),c(-2.5,2.5),c(-2.5,2.5),c(-2,2),c(-1,1))
ylimt2 <- list(ylimt[[1]][1],ylimt[[2]][1],ylimt[[3]][1],ylimt[[4]][1],ylimt[[5]][1])
ylimt3 <- list(abs(ylimt[[1]][2]-ylimt[[1]][1])*0.05,abs(ylimt[[2]][2]-ylimt[[2]][1])*0.05,abs(ylimt[[3]][2]-ylimt[[3]][1])*0.05,abs(ylimt[[4]][2]-ylimt[[4]][1])*0.05,abs(ylimt[[5]][2]-ylimt[[5]][1])*0.05)
pl_tKr <- vector("list", 5)
pl_tKr <- mapply(function(v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13) {
ggplot(data = v1, aes(x2, v2)) +
geom_line(aes(x2, v2), linetype = 1, lwd =1.0, color="red4") +
geom_ribbon(aes(ymin = v3, ymax = v4), alpha = .3, fill="red2", color="red2") +
geom_line(aes(x2, v5), linetype = 1, lwd =1.0, color="blue4") +
geom_ribbon(aes(ymin = v6, ymax = v7), alpha = .3, fill="blue2", color="blue2") +
geom_rect(aes(xmin = 0, xmax = 64, ymin = v10, ymax = v10+v11), alpha = 0.8, fill = 'green4', inherit.aes = FALSE) +
# geom_vline(aes(xintercept = 0.63*length(x1)), colour="black", linetype="dashed",   lwd =1.0) +
# geom_vline(aes(xintercept = mids*length(x2)), colour="magenta", linetype="dashed", lwd =1.0) +
scale_y_continuous(limits=v9, expand = c(0, 0)) +
scale_x_continuous(limits=c(0, 100), expand = c(0, 0), breaks=seq(20,80,20),
labels = c("20%", "40%", "60%", "80%")) +
xlab("") +
ylab(v13) +
ggtitle("") +
theme(plot.title = element_text(lineheight=.8, face="bold", size = 25),
# axis.text.y = eval(parse(text=v6)),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
axis.title.x = element_text(size=20,face="bold", color = "dimgray"),
axis.title.y = element_text(size=20,face="bold", color = "dimgray"),
axis.line = element_line(colour = "black"),
axis.line.x = element_line(size = 2),
plot.margin=unit(v12, "cm"),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank(),
legend.position = v8) +
geom_hline(aes(yintercept=0), colour="black", linetype="dotted", lwd =1.0)
}, sig1, KIN_tHa2, low1, up1, KIN_tLa2, low2, up2, lgp, ylimt, ylimt2, ylimt3, ymarg, ylabs1, SIMPLIFY = F)
pl_tKr[[2]]
pl_tKr[[3]]
pl_tKr[[4]]
pl_tKr[[5]]
ylimt <- list(c(-20,30),c(-2.5,2.5),c(-2.5,2.5),c(-1.5,1.5),c(-1,1))
ylimt2 <- list(ylimt[[1]][1],ylimt[[2]][1],ylimt[[3]][1],ylimt[[4]][1],ylimt[[5]][1])
ylimt3 <- list(abs(ylimt[[1]][2]-ylimt[[1]][1])*0.05,abs(ylimt[[2]][2]-ylimt[[2]][1])*0.05,abs(ylimt[[3]][2]-ylimt[[3]][1])*0.05,abs(ylimt[[4]][2]-ylimt[[4]][1])*0.05,abs(ylimt[[5]][2]-ylimt[[5]][1])*0.05)
pl_tKr <- vector("list", 5)
pl_tKr <- mapply(function(v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13) {
ggplot(data = v1, aes(x2, v2)) +
geom_line(aes(x2, v2), linetype = 1, lwd =1.0, color="red4") +
geom_ribbon(aes(ymin = v3, ymax = v4), alpha = .3, fill="red2", color="red2") +
geom_line(aes(x2, v5), linetype = 1, lwd =1.0, color="blue4") +
geom_ribbon(aes(ymin = v6, ymax = v7), alpha = .3, fill="blue2", color="blue2") +
geom_rect(aes(xmin = 0, xmax = 64, ymin = v10, ymax = v10+v11), alpha = 0.8, fill = 'green4', inherit.aes = FALSE) +
# geom_vline(aes(xintercept = 0.63*length(x1)), colour="black", linetype="dashed",   lwd =1.0) +
# geom_vline(aes(xintercept = mids*length(x2)), colour="magenta", linetype="dashed", lwd =1.0) +
scale_y_continuous(limits=v9, expand = c(0, 0)) +
scale_x_continuous(limits=c(0, 100), expand = c(0, 0), breaks=seq(20,80,20),
labels = c("20%", "40%", "60%", "80%")) +
xlab("") +
ylab(v13) +
ggtitle("") +
theme(plot.title = element_text(lineheight=.8, face="bold", size = 25),
# axis.text.y = eval(parse(text=v6)),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
axis.title.x = element_text(size=20,face="bold", color = "dimgray"),
axis.title.y = element_text(size=20,face="bold", color = "dimgray"),
axis.line = element_line(colour = "black"),
axis.line.x = element_line(size = 2),
plot.margin=unit(v12, "cm"),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank(),
legend.position = v8) +
geom_hline(aes(yintercept=0), colour="black", linetype="dotted", lwd =1.0)
}, sig1, KIN_tHa2, low1, up1, KIN_tLa2, low2, up2, lgp, ylimt, ylimt2, ylimt3, ymarg, ylabs1, SIMPLIFY = F)
pl_tKr[[2]]
pl_tKr[[3]]
pl_tKr[[4]]
pl_tKr[[5]]
trp_Kr <- do.call("grid.arrange", c(pl_tKr[2:5], ncol = 4))
ggsave(filename = "trp_Kr2.png", plot(trp_Kr) ,width = 16, height = 3, units = "in", dpi = 600)
KIN_tHa2 <- lapply(KIN_tHal, '[', 1:100)
KIN_tLa2 <- lapply(KIN_tLal, '[', 1:100)
KIN_tHs2 <- lapply(KIN_tHsl, '[', 1:100)
KIN_tLs2 <- lapply(KIN_tLsl, '[', 1:100)
sig1 <- lapply(KIN_tHa2, as.data.frame)
sig2 <- lapply(KIN_tLa2, as.data.frame)
low1 =  mapply(function(x,y) {x+(-1*qt(0.975,df)*y/sqrt(ns))}, sig1, KIN_tHs2)
up1 =  mapply(function(x,y) {x+(1*qt(0.975,df)*y/sqrt(ns))}, sig1, KIN_tHs2)
low2 =  mapply(function(x,y) {x+(-1*qt(0.975,df)*y/sqrt(ns))}, sig2, KIN_tLs2)
up2 =  mapply(function(x,y) {x+(1*qt(0.975,df)*y/sqrt(ns))}, sig2, KIN_tLs2)
# ylimt <- list(c(-20,30),c(-150,150),c(-400,500),c(-300,300),c(-150,100))
ylimt <- list(c(-20,30),c(-2.5,2.5),c(-2.5,2.5),c(-1.5,1.5),c(-1,1))
ylimt2 <- list(ylimt[[1]][1],ylimt[[2]][1],ylimt[[3]][1],ylimt[[4]][1],ylimt[[5]][1])
ylimt3 <- list(abs(ylimt[[1]][2]-ylimt[[1]][1])*0.05,abs(ylimt[[2]][2]-ylimt[[2]][1])*0.05,abs(ylimt[[3]][2]-ylimt[[3]][1])*0.05,abs(ylimt[[4]][2]-ylimt[[4]][1])*0.05,abs(ylimt[[5]][2]-ylimt[[5]][1])*0.05)
pl_tKl <- vector("list", 5)
pl_tKl <- mapply(function(v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13) {
ggplot(data = v1, aes(x2, v2)) +
geom_line(aes(x2, v2), linetype = 1, lwd =1.0, color="red4") +
geom_ribbon(aes(ymin = v3, ymax = v4), alpha = .3, fill="red2", color="red2") +
geom_line(aes(x2, v5), linetype = 1, lwd =1.0, color="blue4") +
geom_ribbon(aes(ymin = v6, ymax = v7), alpha = .3, fill="blue2", color="blue2") +
geom_rect(aes(xmin = 0, xmax = 14, ymin = v10, ymax = v10+v11), alpha = 0.8, fill = 'green4', inherit.aes = FALSE) +
geom_rect(aes(xmin = 64, xmax = 100, ymin = v10, ymax = v10+v11), alpha = 0.8, fill = 'green4', inherit.aes = FALSE) +
# geom_vline(aes(xintercept = 0.63*length(x1)), colour="black", linetype="dashed",   lwd =1.0) +
# geom_vline(aes(xintercept = mids*length(x2)), colour="magenta", linetype="dashed", lwd =1.0) +
scale_y_continuous(limits=v9, expand = c(0, 0)) +
scale_x_continuous(limits=c(0, 100), expand = c(0, 0), breaks=seq(20,80,20),
labels = c("20%", "40%", "60%", "80%")) +
xlab("") +
ylab(v13) +
ggtitle("") +
theme(plot.title = element_text(lineheight=.8, face="bold", size = 25),
# axis.text.y = eval(parse(text=v6)),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
axis.title.x = element_text(size=20,face="bold", color = "dimgray"),
axis.title.y = element_text(size=20,face="bold", color = "dimgray"),
axis.line = element_line(colour = "black"),
axis.line.x = element_line(size = 2),
plot.margin=unit(v12, "cm"),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank(),
legend.position = v8) +
geom_hline(aes(yintercept=0), colour="black", linetype="dotted", lwd =1.0)
}, sig1, KIN_tHa2, low1, up1, KIN_tLa2, low2, up2, lgp, ylimt, ylimt2, ylimt3, ymarg, ylabs1, SIMPLIFY = F)
pl_tKl[[2]]
pl_tKl[[3]]
pl_tKl[[4]]
pl_tKl[[5]]
KIN_tHa2 <- lapply(KIN_tHal, '[', 1:100)
KIN_tLa2 <- lapply(KIN_tLal, '[', 1:100)
KIN_tHs2 <- lapply(KIN_tHsl, '[', 1:100)
KIN_tLs2 <- lapply(KIN_tLsl, '[', 1:100)
sig1 <- lapply(KIN_tHa2, as.data.frame)
sig2 <- lapply(KIN_tLa2, as.data.frame)
low1 =  mapply(function(x,y) {x+(-1*qt(0.975,df)*y/sqrt(ns))}, sig1, KIN_tHs2)
up1 =  mapply(function(x,y) {x+(1*qt(0.975,df)*y/sqrt(ns))}, sig1, KIN_tHs2)
low2 =  mapply(function(x,y) {x+(-1*qt(0.975,df)*y/sqrt(ns))}, sig2, KIN_tLs2)
up2 =  mapply(function(x,y) {x+(1*qt(0.975,df)*y/sqrt(ns))}, sig2, KIN_tLs2)
# ylimt <- list(c(-20,30),c(-150,150),c(-400,500),c(-300,300),c(-150,100))
ylimt <- list(c(-20,30),c(-2.5,2.5),c(-2.5,2.5),c(-1.5,2),c(-1,1))
ylimt2 <- list(ylimt[[1]][1],ylimt[[2]][1],ylimt[[3]][1],ylimt[[4]][1],ylimt[[5]][1])
ylimt3 <- list(abs(ylimt[[1]][2]-ylimt[[1]][1])*0.05,abs(ylimt[[2]][2]-ylimt[[2]][1])*0.05,abs(ylimt[[3]][2]-ylimt[[3]][1])*0.05,abs(ylimt[[4]][2]-ylimt[[4]][1])*0.05,abs(ylimt[[5]][2]-ylimt[[5]][1])*0.05)
pl_tKl <- vector("list", 5)
pl_tKl <- mapply(function(v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13) {
ggplot(data = v1, aes(x2, v2)) +
geom_line(aes(x2, v2), linetype = 1, lwd =1.0, color="red4") +
geom_ribbon(aes(ymin = v3, ymax = v4), alpha = .3, fill="red2", color="red2") +
geom_line(aes(x2, v5), linetype = 1, lwd =1.0, color="blue4") +
geom_ribbon(aes(ymin = v6, ymax = v7), alpha = .3, fill="blue2", color="blue2") +
geom_rect(aes(xmin = 0, xmax = 14, ymin = v10, ymax = v10+v11), alpha = 0.8, fill = 'green4', inherit.aes = FALSE) +
geom_rect(aes(xmin = 64, xmax = 100, ymin = v10, ymax = v10+v11), alpha = 0.8, fill = 'green4', inherit.aes = FALSE) +
# geom_vline(aes(xintercept = 0.63*length(x1)), colour="black", linetype="dashed",   lwd =1.0) +
# geom_vline(aes(xintercept = mids*length(x2)), colour="magenta", linetype="dashed", lwd =1.0) +
scale_y_continuous(limits=v9, expand = c(0, 0)) +
scale_x_continuous(limits=c(0, 100), expand = c(0, 0), breaks=seq(20,80,20),
labels = c("20%", "40%", "60%", "80%")) +
xlab("") +
ylab(v13) +
ggtitle("") +
theme(plot.title = element_text(lineheight=.8, face="bold", size = 25),
# axis.text.y = eval(parse(text=v6)),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
axis.title.x = element_text(size=20,face="bold", color = "dimgray"),
axis.title.y = element_text(size=20,face="bold", color = "dimgray"),
axis.line = element_line(colour = "black"),
axis.line.x = element_line(size = 2),
plot.margin=unit(v12, "cm"),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank(),
legend.position = v8) +
geom_hline(aes(yintercept=0), colour="black", linetype="dotted", lwd =1.0)
}, sig1, KIN_tHa2, low1, up1, KIN_tLa2, low2, up2, lgp, ylimt, ylimt2, ylimt3, ymarg, ylabs1, SIMPLIFY = F)
pl_tKl[[3]]
pl_tKl[[4]]
pl_tKl[[5]]
trp_Kl <- do.call("grid.arrange", c(pl_tKl[2:5], ncol = 4))
ggsave(filename = "trp_Kl2.png", plot(trp_Kl) ,width = 16, height = 3, units = "in", dpi = 600)
jet.colors <- colorRampPalette(c("#00007F", "blue", "#007FFF", "cyan", "#7FFF7F", "yellow", "#FF7F00", "red", "#7F0000"))
lgp <- as.list(c("none", "none","none","none","none"))  # legend position
ymarg <- list(c(0.2, 0.1, 0, 0), c(0.2, 0.1, 0, 0), c(0.2, 0.1, 0, 0), c(0.2, 0.1, 0, 0), c(0.2, 0.1, 0, 0))
# tty <- as.list(c("", "Leg angle", "Ankle angle", "Knee angle", "Hip angle"))
tty <- as.list(c("", "Heel AP", "Ankle AP", "Knee AP", "Hip AP"))
# ylabs1 <- as.list(c("Ipsi. (deg/m)", "Ipsi. (deg/m)", "", "", ""))
# ylabs2 <- as.list(c("Contra. (deg/m)", "Contra. (deg/m)", "", "", ""))
ylabs1 <- as.list(c("Ipsi. (m/m)", "Ipsi. (m/m)", "", "", ""))
ylabs2 <- as.list(c("Contra. (m/m)", "Contra. (m/m)", "", "", ""))
# ylabs3 <- as.list(c("deg", "deg", "", "", ""))
ylabs3 <- as.list(c("m", "m", "", "", ""))
# KIN (transient) Right
KIN_tHa2 <- lapply(KIN_tHar, '[', 1:100)
KIN_tLa2 <- lapply(KIN_tLar, '[', 1:100)
KIN_tHs2 <- lapply(KIN_tHsr, '[', 1:100)
KIN_tLs2 <- lapply(KIN_tLsr, '[', 1:100)
sig1 <- lapply(KIN_tHa2, as.data.frame)
sig2 <- lapply(KIN_tLa2, as.data.frame)
low1 =  mapply(function(x,y) {x+(-1*qt(0.975,df)*y/sqrt(ns))}, sig1, KIN_tHs2)
up1 =  mapply(function(x,y) {x+(1*qt(0.975,df)*y/sqrt(ns))}, sig1, KIN_tHs2)
low2 =  mapply(function(x,y) {x+(-1*qt(0.975,df)*y/sqrt(ns))}, sig2, KIN_tLs2)
up2 =  mapply(function(x,y) {x+(1*qt(0.975,df)*y/sqrt(ns))}, sig2, KIN_tLs2)
ylimt <- list(c(-20,30),c(-2.5,2.5),c(-2.5,2.5),c(-1.5,1.5),c(-1,1))
ylimt2 <- list(ylimt[[1]][1],ylimt[[2]][1],ylimt[[3]][1],ylimt[[4]][1],ylimt[[5]][1])
ylimt3 <- list(abs(ylimt[[1]][2]-ylimt[[1]][1])*0.05,abs(ylimt[[2]][2]-ylimt[[2]][1])*0.05,abs(ylimt[[3]][2]-ylimt[[3]][1])*0.05,abs(ylimt[[4]][2]-ylimt[[4]][1])*0.05,abs(ylimt[[5]][2]-ylimt[[5]][1])*0.05)
pl_tKr <- vector("list", 5)
pl_tKr <- mapply(function(v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13) {
ggplot(data = v1, aes(x2, v2)) +
geom_line(aes(x2, v2), linetype = 1, lwd =1.0, color="red4") +
geom_ribbon(aes(ymin = v3, ymax = v4), alpha = .3, fill="red2", color="red2") +
geom_line(aes(x2, v5), linetype = 1, lwd =1.0, color="blue4") +
geom_ribbon(aes(ymin = v6, ymax = v7), alpha = .3, fill="blue2", color="blue2") +
geom_rect(aes(xmin = 0, xmax = 64, ymin = v10, ymax = v10+v11), alpha = 0.8, fill = 'green4', inherit.aes = FALSE) +
# geom_vline(aes(xintercept = 0.63*length(x1)), colour="black", linetype="dashed",   lwd =1.0) +
# geom_vline(aes(xintercept = mids*length(x2)), colour="magenta", linetype="dashed", lwd =1.0) +
scale_y_continuous(limits=v9, expand = c(0, 0)) +
scale_x_continuous(limits=c(0, 100), expand = c(0, 0), breaks=seq(20,80,20),
labels = c("20%", "40%", "60%", "80%")) +
xlab("") +
ylab(v13) +
ggtitle("") +
theme(plot.title = element_text(lineheight=.8, face="bold", size = 25),
# axis.text.y = eval(parse(text=v6)),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
axis.title.x = element_text(size=20,face="bold", color = "dimgray"),
axis.title.y = element_text(size=20,face="bold", color = "dimgray"),
axis.line = element_line(colour = "black"),
axis.line.x = element_line(size = 2),
plot.margin=unit(v12, "cm"),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank(),
legend.position = v8) +
geom_hline(aes(yintercept=0), colour="black", linetype="dotted", lwd =1.0)
}, sig1, KIN_tHa2, low1, up1, KIN_tLa2, low2, up2, lgp, ylimt, ylimt2, ylimt3, ymarg, ylabs1, SIMPLIFY = F)
trp_Kr <- do.call("grid.arrange", c(pl_tKr[2:5], ncol = 4))
ggsave(filename = "trp_Kr2.png", plot(trp_Kr) ,width = 16, height = 3, units = "in", dpi = 600)
# KIN (transient) Left
KIN_tHa2 <- lapply(KIN_tHal, '[', 1:100)
KIN_tLa2 <- lapply(KIN_tLal, '[', 1:100)
KIN_tHs2 <- lapply(KIN_tHsl, '[', 1:100)
KIN_tLs2 <- lapply(KIN_tLsl, '[', 1:100)
sig1 <- lapply(KIN_tHa2, as.data.frame)
sig2 <- lapply(KIN_tLa2, as.data.frame)
low1 =  mapply(function(x,y) {x+(-1*qt(0.975,df)*y/sqrt(ns))}, sig1, KIN_tHs2)
up1 =  mapply(function(x,y) {x+(1*qt(0.975,df)*y/sqrt(ns))}, sig1, KIN_tHs2)
low2 =  mapply(function(x,y) {x+(-1*qt(0.975,df)*y/sqrt(ns))}, sig2, KIN_tLs2)
up2 =  mapply(function(x,y) {x+(1*qt(0.975,df)*y/sqrt(ns))}, sig2, KIN_tLs2)
# ylimt <- list(c(-20,30),c(-150,150),c(-400,500),c(-300,300),c(-150,100))
ylimt <- list(c(-20,30),c(-2.5,2.5),c(-2.5,2.5),c(-1.5,2),c(-1,1))
ylimt2 <- list(ylimt[[1]][1],ylimt[[2]][1],ylimt[[3]][1],ylimt[[4]][1],ylimt[[5]][1])
ylimt3 <- list(abs(ylimt[[1]][2]-ylimt[[1]][1])*0.05,abs(ylimt[[2]][2]-ylimt[[2]][1])*0.05,abs(ylimt[[3]][2]-ylimt[[3]][1])*0.05,abs(ylimt[[4]][2]-ylimt[[4]][1])*0.05,abs(ylimt[[5]][2]-ylimt[[5]][1])*0.05)
pl_tKl <- vector("list", 5)
pl_tKl <- mapply(function(v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13) {
ggplot(data = v1, aes(x2, v2)) +
geom_line(aes(x2, v2), linetype = 1, lwd =1.0, color="red4") +
geom_ribbon(aes(ymin = v3, ymax = v4), alpha = .3, fill="red2", color="red2") +
geom_line(aes(x2, v5), linetype = 1, lwd =1.0, color="blue4") +
geom_ribbon(aes(ymin = v6, ymax = v7), alpha = .3, fill="blue2", color="blue2") +
geom_rect(aes(xmin = 0, xmax = 14, ymin = v10, ymax = v10+v11), alpha = 0.8, fill = 'green4', inherit.aes = FALSE) +
geom_rect(aes(xmin = 64, xmax = 100, ymin = v10, ymax = v10+v11), alpha = 0.8, fill = 'green4', inherit.aes = FALSE) +
# geom_vline(aes(xintercept = 0.63*length(x1)), colour="black", linetype="dashed",   lwd =1.0) +
# geom_vline(aes(xintercept = mids*length(x2)), colour="magenta", linetype="dashed", lwd =1.0) +
scale_y_continuous(limits=v9, expand = c(0, 0)) +
scale_x_continuous(limits=c(0, 100), expand = c(0, 0), breaks=seq(20,80,20),
labels = c("20%", "40%", "60%", "80%")) +
xlab("") +
ylab(v13) +
ggtitle("") +
theme(plot.title = element_text(lineheight=.8, face="bold", size = 25),
# axis.text.y = eval(parse(text=v6)),
axis.text.x = element_text(size = 15),
axis.text.y = element_text(size = 15),
axis.title.x = element_text(size=20,face="bold", color = "dimgray"),
axis.title.y = element_text(size=20,face="bold", color = "dimgray"),
axis.line = element_line(colour = "black"),
axis.line.x = element_line(size = 2),
plot.margin=unit(v12, "cm"),
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank(),
legend.position = v8) +
geom_hline(aes(yintercept=0), colour="black", linetype="dotted", lwd =1.0)
}, sig1, KIN_tHa2, low1, up1, KIN_tLa2, low2, up2, lgp, ylimt, ylimt2, ylimt3, ymarg, ylabs1, SIMPLIFY = F)
trp_Kl <- do.call("grid.arrange", c(pl_tKl[2:5], ncol = 4))
ggsave(filename = "trp_Kl2.png", plot(trp_Kl) ,width = 16, height = 3, units = "in", dpi = 600)
